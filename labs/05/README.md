# Лабораторная работа №5

## Задания

Ознакомьтесь со стандартными классами [`std::thread`](https://en.cppreference.com/w/cpp/thread/thread)
и [`std::jthread`](https://en.cppreference.com/w/cpp/thread/jthread).
Используйте их, чтобы выполнить предложенные задания задания.

- Для получения оценки "удовлетворительно" нужно набрать не менее X баллов.
- Для получения оценки "хорошо" нужно набрать не менее Y баллов.
- Для получения оценки "отлично" нужно набрать не менее Z баллов.

### Требования

Обязательно проверяйте успешность всех вызовов функций операционной системы и не оставляйте ошибки незамеченными.

Ваш код должен иметь уровень безопасности исключений не ниже базового.
Для этого разработайте (или возьмите готовую) RAII-обёртку, автоматизирующую
управление ресурсами операционной системы.

### Задание 1 — Потокобезопасное множество — 50 баллов

Ознакомьтесь с классами [`std::mutex`](https://en.cppreference.com/w/cpp/thread/mutex)
и [`std::shared_mutex`](https://en.cppreference.com/w/cpp/thread/shared_mutex), а также обёртками
[`std::unique_lock`](https://en.cppreference.com/w/cpp/thread/unique_lock) м
[`std::shared_lock`](https://en.cppreference.com/w/cpp/thread/shared_lock).

Напишите программу, которая строит `unordered_set<uint64_t>` из простых чисел
в диапазоне от 0 до введённого пользователем числа.
Ограничения этой задачи не позволяют использовать решето Эратосфена,
поэтому приходится искать простые числа перебором нечётных делителей от 2 до $\sqrt N$.

Чтобы ускорить решение задачи, распределите поиск делителей между несколькими потоками.

Чтобы избежать состояния гонки потоков, напишите шаблонный класс `ThreadsafeSet`
(потокобезопасное множество), предоставляющий потокобезопасные операции
для доступа к множеству.

```c++
template <typename T, typename H = std::hash<T>, typename Comp = std::equal_to<T>>
class ThreadsafeSet
{
public:
    // Разместите здесь операции, которые можно безопасно вызывать из нескольких потоков
private:
    std::unordered_set<T, H, Comp> m_set;
};
```

Ваша программа должна измерить время работы алгоритма в одном потоке (использующего `unordered_set`),
а также время работы многопоточного алгоритма, использующего `ThreadsafeSet`.

Постройте диаграмму, отображающую время работы алгоритма для верхней границы в 1 млн, 10 млн, 100 млн
при количестве потоков от 1 до 16.

Проанализируйте полученные результаты и сделайте выводы.

### Задание 2

### Задание 3

### Задание 4
