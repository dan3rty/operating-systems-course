# Лабораторная работа №1

- [Лабораторная работа №1](#лабораторная-работа-1)
  - [Задания](#задания)
    - [Задание 1 - sys-info-win](#задание-1---sys-info-win)
    - [Задание 2 - sys-info-linux](#задание-2---sys-info-linux)
      - [Пример выводимой информации](#пример-выводимой-информации)
      - [Подсказки](#подсказки)
    - [Задание 3 - sys-info-crossplatform](#задание-3---sys-info-crossplatform)
      - [Подсказки](#подсказки-1)
    - [Задание 4 — secret](#задание-4--secret)
      - [Вариант 1](#вариант-1)
  - [ССылки](#ссылки)

## Задания

### Задание 1 - sys-info-win

Напишите программу sys-info-win для ОС Windows, которая бы выводила в консоль информацию о компьютере на котором она запущена:

- Версия операционной системы
- Количество свободной и имеющейся виртуальной памяти (в мегабайтах)
- Количество ядер процессора

### Задание 2 - sys-info-linux

Напишите программу sys-info-linux для ОС Linux, которая бы выводила в консоль информацию о компьютере, на котором запущена:

- Информация об операционной системе (название, релиз и версия)
- Количество свободной и имеющейся виртуальной памяти (в мегабайтах)
- Количество логических процессоров

#### Пример выводимой информации

```txt
sysname: Linux
release: 5.15.153.1-microsoft-standard-WSL2
version: #1 SMP Fri Mar 29 23:14:13 UTC 2024
processors: 16
RAM:6417MB / 7796MB
```

#### Подсказки

- Используйте функции `get_nprocs_conf`, `uname`, `sysinfo`, чтобы получить необходимую информацию.

### Задание 3 - sys-info-crossplatform

Разработайте класс `SysInfo`, предоставляющий методы для получения информации о системе из заданий:

- Название и версия ОС
- Количество логических процессоров
- Количество свободной и установленной оперативной памяти

Класс должен быть возможно скомпилировать как под Windows, так и под Linux. Публичный интерфейс класса представлен ниже.

```c++
class SysInfo
{
public:
    std::string GetOSName() const;
    std::string GetOSVersion() const;
    uint64_t GetFreeMemory() const;
    uint64_t GetTotalMemory() const;
    unsigned GetProcessorCount() const;
};
```

Разработайте на основе этого класса консольное приложение **sys-info**, выводящее в консоль информацию о компьютере
и операционной системе.

Для сборки приложения должна использоваться система сборки CMake.
Приложение должно собираться как под Windows, так и под Linux.

#### Подсказки

- Используйте директивы управления компиляцией `#ifdef`, `#ifndef`, `#else`, `#endif` и другие,
чтобы подключить нужные заголовочные функции и использовать необходимые функции.

### Задание 4 — secret

#### Вариант 1

Один программист написал для одной очень важной программы очень важную функцию на ассемблере для процессоров семейства x86-64,
а потом со скандалом уволился и прекратил сотрудничество с компанией.

Вскоре выяснилось, что эта функция работает недостаточно быстро при больших значениях входных параметров.
Кроме того возникла необходимость портировать программу на другие процессорные архитектуры, такие как ARM и RISC V.

Вас наняли, чтобы решить эту проблему. Вы должны:

- Восстановите алгоритм работы этой функции.
- Дайте её подходящее имя.
- Перепишите её на языке C или C++, чтобы она была более читаемой.
- Оптимизируйте её работу.

Известно, что входной параметр функция принимает в регистре `EDI`, а возвращает результат в регистре `EAX`.

Исходный код функции представлен ниже:

```assembly
Foo:
        xor     eax, eax
        cmp     edi, 1
        jle     .L1
        cmp     edi, 2
        je      .L6
        test    dil, 1
        je      .L1
        mov     ecx, 2
        jmp     .L3
.L4:
        mov     eax, edi
        cdq
        idiv    ecx
        test    edx, edx
        je      .L8
.L3:
        add     ecx, 1
        cmp     edi, ecx
        jne     .L4
.L6:
        mov     eax, 1
        ret
.L8:
        xor     eax, eax
.L1:
        ret
```

Для демонстрации работы написанной функции напишите программу, которая:

- считывает из stdin значение аргумента
- вызывает написанную вами функцию и выводит её результат в stdout.

Программа должна собираться системой сборки CMake под Windows и Linux.

## ССылки

- [Linux man-pages project](https://www.kernel.org/doc/man-pages/) - поисковик по документации ядра Linux.
- [Система сборки CMake](https://cmake.org/).
